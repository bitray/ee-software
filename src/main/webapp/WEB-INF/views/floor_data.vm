#set($layout="layout/main.vm")
<!-- bootstrap-daterangepicker -->
<link
	href="${rc.contextPath}/static/vendors/bootstrap-daterangepicker/daterangepicker.css"
	rel="stylesheet">
	<link href="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.css" rel="stylesheet">
    <link href="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.buttons.css" rel="stylesheet">
    <link href="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.nonblock.css" rel="stylesheet">
<script>
function createFloor() {
		var floorNum = $("#floorNum").val();
		if(!$.trim(floorNum).length<1){
		$.post("${rc.contextPath}/base_data/floor_data_insert", {
			floorNum : floorNum
		}, function(data, status) {
			if (data) {
				new PNotify({
	                  title: '保存成功',
	                  text: '新增成功了，都好了',
	                  type: 'success',
	                  width: '400px',
	                  hide: false,
    				  min_height: '100px',
	                  styling: 'bootstrap3',
	                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				                window.location.reload();
				            }
				        },
				        null]
					    }
	              });
			} else {
				new PNotify({
                  title: '错误',
                  text: '数据添加失败',
                  type: 'error',
                  width: '400px',
					min_height: '100px',
                  styling: 'bootstrap3',
                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				            }
				        },
				        null]
					    }
              });
			}
		});
		}else{
			new PNotify({
                  title: '错误',
                  text: '楼层不可以为空',
                  type: 'error',
                  width: '400px',
				  min_height: '100px',
                  styling: 'bootstrap3',
                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				            }
				        },
				        null]
					    }
              });
		}
	}
	
	function openUpdateTitle(floorId,floorNum){
		$("#floorNumForUpdate").val(floorNum);
		$("#floorId").val(floorId);
		$('#updateDiv').modal('show');
		
	}

	function updateFloor(){
		var floorNum=$("#floorNumForUpdate").val();
		var floorId=$("#floorId").val();
		$.post("${rc.contextPath}/base_data/floor_data_update", {
			floorId : floorId,
			floorNum:floorNum
		}, function(data, status) {
			if (data) {
				new PNotify({
	                  title: '修改成功',
	                  text: '修改成功了，都好了',
	                  type: 'success',
	                  width: '400px',
	                  hide: false,
    				  min_height: '100px',
	                  styling: 'bootstrap3',
	                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				                window.location.reload();
				            }
				        },
				        null]
					    }
	              });
			} else {
				new PNotify({
                  title: '错误',
                  text: '数据修改失败',
                  type: 'error',
                  width: '400px',
					min_height: '100px',
                  styling: 'bootstrap3',
                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				                $('#updateDiv').modal('hide');
				            }
				        },
				        null]
					    }
              });
			}
		});
	}

	function deleteFloor(floorId){
		$.post("${rc.contextPath}/base_data/floor_data_delete", {
			floorId : floorId
		}, function(data, status) {
			if (data) {
				new PNotify({
	                  title: '删除成功',
	                  text: '删除成功了，都好了',
	                  type: 'success',
	                  width: '400px',
	                  hide: false,
    				  min_height: '100px',
	                  styling: 'bootstrap3',
	                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				                window.location.reload();
				            }
				        },
				        null]
					    }
	              });
			} else {
				new PNotify({
                  title: '错误',
                  text: '数据删除失败',
                  type: 'error',
                  width: '400px',
					min_height: '100px',
                  styling: 'bootstrap3',
                  confirm: {
				        confirm: true,
				        buttons: [{
				            text: '确定',
				            addClass: 'btn-primary',
				            click: function(notice) {
				                notice.remove();
				            }
				        },
				        null]
					    }
              });
			}
		});
		
	
	}

	$(document).ready(function() {
		$("#createdFloor").click(function(){
			createFloor();
		});
		$("#cancelCreate").click(function(){
			$("#demo-form1")[0].reset()
		});
		$("#cancelUpdate").click(function(){
			$("#demo-form2")[0].reset()
		});
		
	});

</script>	
<div class="">
	<div class="page-title">
		<div class="title_left">
			<h3 style="color: green;">楼层数据维护</h3>
		</div>

	</div>

	<div class="clearfix"></div>

	<div class="row">
		<div class="col-md-12">
			<div 
				class="col-md-3 col-sm-6 col-xs-12">
				<button type="button" class="btn btn-success" data-toggle="modal"
					data-target="#createDiv">新增</button>
				##<button type="button" class="btn btn-warning" data-toggle="modal" data-target="#updateDiv">修改</button>
				##<button type="button" class="btn btn-danger">删除</button>
			</div>
			<div class="x_panel">
				<div class="x_content">
					<table class="table">
						<thead>
							<tr>
								<th>#</th>
								<th>楼层名</th>
								<th>操作</th>
							</tr>
						</thead>
						<tbody>
							#foreach( $elem in $list)
							<tr>
								<th scope="row">$!{velocityCount}</th>
								<td>$elem.floorNumber</td>
								<td>
									<button id="updateFloor$!{velocityCount}" type="button" class="btn btn-warning" onclick="openUpdateTitle('$!{elem.id}','$!{elem.floorNumber}')">修改</button>
									<button id="removeFloor$!{velocityCount}" type="button" class="btn btn-danger" onclick="deleteFloor('$!{elem.id}')">删除</button>
								</td>
							</tr>
							#end
						</tbody>
					</table>

				</div>
				<div class="modal fade bs-example-modal-sm" id="createDiv" tabindex="-1"
					role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-sm">
						<div class="modal-content">

							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
								<h4 class="modal-title" id="myModalLabel2">新增楼层</h4>
							</div>
							<div class="modal-body">
								<form id="demo-form1" data-parsley-validate
									class="form-horizontal form-label-left">
									<div class="form-group">
										<label class="control-label col-md-4 col-sm-3 col-xs-12"
											for="last-name">楼层名 <span class="required">*</span>
										</label>
										<div class="col-md-6 col-sm-6 col-xs-12">
											<input type="text" id="floorNum" name="floorNum"
												required="required" class="form-control col-md-7 col-xs-12">
										</div>
									</div>								
								</form>
							</div>
							<div class="modal-footer">
								<button id="cancelCreate" type="button" class="btn btn-default"
									data-dismiss="modal">关闭</button>
								<button id="createdFloor" class="btn btn-default source">保存</button>
							</div>

						</div>
					</div>
				</div>
				
				<div class="modal fade bs-example-modal-sm" id="updateDiv" tabindex="-1"
					role="dialog" aria-hidden="true">
					<div class="modal-dialog modal-sm">
						<div class="modal-content">

							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
								<h4 class="modal-title" id="myModalLabel2">修改楼层</h4>
							</div>
							<div class="modal-body">
								<form id="demo-form2" data-parsley-validate
									class="form-horizontal form-label-left">
									<div class="form-group">
										<label class="control-label col-md-4 col-sm-3 col-xs-12"
											for="last-name">楼层名 <span class="required">*</span>
										</label>
										<div class="col-md-6 col-sm-6 col-xs-12">
											<input type="text" id="floorNumForUpdate" name="floorNumForUpdate" value="123"
												required="required" class="form-control col-md-7 col-xs-12">
										</div>
										<input id="floorId" type="hidden" value=""/>
									</div>									
								</form>
							</div>
							<div class="modal-footer">
								<button id="cancelUpdate" type="button" class="btn btn-default"
									data-dismiss="modal">关闭</button>
								<button class="btn btn-default source" onclick="updateFloor()">保存</button>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="${rc.contextPath}/static/vendors/moment/min/moment.min.js"></script>
<script
	src="${rc.contextPath}/static/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- bootstrap-daterangepicker -->
<script>
	$(document).ready(function() {
		$('#birthday').daterangepicker({
			singleDatePicker : true,
			calender_style : "picker_4"
		}, function(start, end, label) {
			console.log(start.toISOString(), end.toISOString(), label);
		});
		$('#birthday2').daterangepicker({
			singleDatePicker : true,
			calender_style : "picker_4"
		}, function(start, end, label) {
			console.log(start.toISOString(), end.toISOString(), label);
		});
	});
</script>
<!-- /bootstrap-daterangepicker -->
    <script src="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.js"></script>
    <script src="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.buttons.js"></script>
    <script src="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.confirm.js"></script>
    <script src="${rc.contextPath}/static/vendors/pnotify/dist/pnotify.nonblock.js"></script>
